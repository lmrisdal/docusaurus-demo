"use strict";(self.webpackChunkdocusaurus_demo=self.webpackChunkdocusaurus_demo||[]).push([[2593],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=p(n),d=r,g=m["".concat(l,".").concat(d)]||m[d]||c[d]||s;return n?i.createElement(g,a(a({ref:t},u),{},{components:n})):i.createElement(g,a({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,a=new Array(s);a[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:r,a[1]=o;for(var p=2;p<s;p++)a[p]=n[p];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5336:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c}});var i=n(7462),r=n(3366),s=(n(7294),n(3905)),a=["components"],o={},l="Splitting",p={unversionedId:"Transformation/splitting",id:"Transformation/splitting",title:"Splitting",description:"ConnXio (CX) gives customers the ability to split messages into smaller units. We do this by running the content through a Code Component that defines how the file should be split and then sends the smaller units through the pipeline as new messages. This page describes how to utilize the splitting functionality.",source:"@site/docs/Transformation/splitting.md",sourceDirName:"Transformation",slug:"/Transformation/splitting",permalink:"/docusaurus-demo/Transformation/splitting",draft:!1,editUrl:"https://github.com/lmrisdal/docusaurus-demo/tree/main/docs/Transformation/splitting.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Prettify Content",permalink:"/docusaurus-demo/Transformation/prettify"},next:{title:"Variable Replacement",permalink:"/docusaurus-demo/Transformation/variable-replacement"}},u={},c=[{value:"Limitations",id:"limitations",level:2},{value:"Testing and best practices",id:"testing-and-best-practices",level:2},{value:"Creating splitting code components",id:"creating-splitting-code-components",level:2},{value:"Retry",id:"retry",level:2}],m={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,a);return(0,s.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"splitting"},"Splitting"),(0,s.kt)("p",null,"ConnXio (CX) gives customers the ability to split messages into smaller units. We do this by running the content through a ",(0,s.kt)("a",{parentName:"p",href:"/Transformation/Code-Components"},"Code Component")," that defines how the file should be split and then sends the smaller units through the pipeline as new messages. This page describes how to utilize the splitting functionality."),(0,s.kt)("h2",{id:"limitations"},"Limitations"),(0,s.kt)("p",null,"There are very few limits to splitting the only one being that we support files up to ",(0,s.kt)("inlineCode",{parentName:"p"},"100mb")," only. However, you can split files into any amount of messages, and process them in any shape or form in further transformations. After the splitting is run all files will be handled as a unique message inside CX which means they will generate separate ",(0,s.kt)("a",{parentName:"p",href:"/Logging"},"logs"),", ",(0,s.kt)("a",{parentName:"p",href:"/Resending"},"resend-events")," and errors."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Splitting can generate enormous amounts of traffic. Be sure that you test your receiving systems thoroughly before you send production level loads.")),(0,s.kt)("h2",{id:"testing-and-best-practices"},"Testing and best practices"),(0,s.kt)("p",null,"Splitting requires special care when testing since it can generate millions of messages in a short amount of time. CX has a heavily tuned splitting algorithm that utilizes parallelization to generate messages in a rate of about 4000 per second at full capacity. This means that we recommend the following test pipeline:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Test you integration with a single file that splits into 2 messages."),(0,s.kt)("li",{parentName:"ol"},"Add 2 files with 200 messages."),(0,s.kt)("li",{parentName:"ol"},"Test 2 files with progressively larger loads (we recommend multiplying by 10 at a time) until you reach production level.")),(0,s.kt)("p",null,"Obviously you can ignore steps that are unrealistic for production level load, ie. if you are estimating a load of 10 messages a day you can go straight to testing with production load levels. We do ask that you test for ",(0,s.kt)("strong",{parentName:"p"},"peak load traffic")," multiplied by 2. This adds stability for unexpected scenario's as well a prepares the receiving system for future load.\\\nThe reason for this recommended testing pipeline is that testing generates traffic which is payable, and we do not want our customers to incur costs for failed test runs caused by non-tested code and bad setup."),(0,s.kt)("h2",{id:"creating-splitting-code-components"},"Creating splitting code components"),(0,s.kt)("p",null,"When implementing splitting into your integration the first step is to create the code that splits your message into smaller components. This is done in more or less the same way as ",(0,s.kt)("a",{parentName:"p",href:"/Transformation/Code-Components"},"map code components")," but with a few key differences."),(0,s.kt)("p",null,"Firstly you need to create the splitting code itself, see the map components page for a simple rundown of the process, but instead of using the boiler plate described there for maps you use the  for splitting detailed below:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'public class Initialize\n{\n      /// <summary>\n    /// Method name must be Split and class name Initialize\n    /// </summary>\n    /// <param name="originalMessage"The whole input message</param>\n    /// <param name="encoding">Added mostly for backwards compatibility, is always utf-8</param>\n    /// <returns>List with new messages</returns>\n    public List<string> Split(byte[] originalMessage, Encoding encoding)\n    {\n        //Create object from byte array\n        var inboundMessage = JsonConvert.DeserializeObject<InboundMessage>(encoding.GetString(originalMessage));\n        \n        //Create list that holds new messages\n        var outboundStringList = new List<string>();\n\n        //Add elements to list\n        foreach(var city in inboundMessage.Cities)\n        {\n            var outboundMessage = new OutboundMessage\n            {\n                CityName = city.CityName,\n                Comment = city.Comment,\n                Id = inboundMessage.Id\n            };\n \n            outboundStringList.Add(JsonConvert.SerializeObject(outboundMessage));\n        }\n\n        //Return new messages as list\n        return outboundStringList;\n    }\n}\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Upload the component")," by using the methods described on the ",(0,s.kt)("a",{parentName:"p",href:"/Transformation/Code-Components"},"code components page"),". Remember to choose the ",(0,s.kt)("em",{parentName:"p"},"splitting")," type."),(0,s.kt)("h2",{id:"retry"},"Retry"),(0,s.kt)("p",null,"Splitting has multiple retry patterns that differ based on which step of the splitting process that fails. If the process fails on transient errors before running the splitting code component the system puts the original messages back in queue and tries again 10 times. If the failure is happens after running the splitting code the algorithm tries to send the message to the next pipeline step multiple times with increasing delay until the message is scheduled for retry through the ",(0,s.kt)("a",{parentName:"p",href:"/Retry"},"disaster pipeline"),"."),(0,s.kt)("p",null,"REtry can end up causing delays in the delivery of splitted message units. If you experience problems like this, your logging provider should have received warnings about the fault, if not please contact your representative."))}d.isMDXComponent=!0}}]);